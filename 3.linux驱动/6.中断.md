## 一、中断号

设备树中定义中断号

```c
//厂家定义好的，在dtsi中
gpx1: gpx1 {
    gpio-controller;
    #gpio-cells = <2>;

    interrupt-controller;
    interrupt-parent = <&gic>;
    interrupts = <0 24 0>, <0 25 0>, <0 26 0>, <0 27 0>,
    <0 28 0>, <0 29 0>, <0 30 0>, <0 31 0>;
    #interrupt-cells = <2>;
};
```

在开发过程中需要定义自己的节点

```c
key_node{
    compatible = "test_key";
    interrupt-parent = <&gpx1>;
    interrupts = <2 4>;
};
```



## 二、获取中断号

1.获取设备树对应节点

```c
struct device_node *of_find_node_by_path(const char *path)
```

2.通过节点获取中断号

```c
unsigned int irq_of_parse_and_map(struct device_node *dev,int index)
```



例如：

```c
// 获取到设备树中到节点
struct device_node *np = of_find_node_by_path("/key_node");
if(np){
    printk("find node ok\n");
}else{
    printk("find node failed\n");
}

// 通过节点去获取到中断号码
int irqno = irq_of_parse_and_map(np, 0);
printk("irqno = %d\n", irqno);

```

